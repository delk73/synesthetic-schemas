{
  "version": "v0.7.3",
  "spec_ref": "meta/spec.schema.flow.md#synesthetic-schemas-internal-specification",
  "task": "Repository State Compliance Audit",
  "owner": "Synesthetic Schemas WG",
  "lastReviewed": "2025-10-13",
  "objective": "Assess repository conformance to the internal Synesthetic Schemas specification for authoring, transformation, and publication at version v0.7.3. No code execution or validation is performed.",
  "scope": {
    "files": [
      "jsonschema/*.schema.json",
      "docs/schema/0.7.3/*.schema.json",
      "version.json",
      "Makefile",
      "build.sh",
      "preflight.sh",
      "scripts/*.py",
      "examples/*.json",
      "python/src/synesthetic_schemas/",
      "typescript/src/"
    ]
  },
  "constraints": {
    "style": "deterministic, terse, Markdown headings + tables",
    "rules": [
      "jsonschema/ is the only editable source and must retain placeholder host https://schemas.synesthetic.dev/<version>/ in all $id and $ref fields.",
      "docs/schema/<version>/ must contain generated immutable outputs rewritten to https://delk73.github.io/synesthetic-schemas/schema/<version>/ for all $id and $ref fields.",
      "Relative or mixed-host $ref entries are invalid in published artifacts.",
      "Normalization scripts must not modify jsonschema/*.schema.json or introduce transient keys.",
      "version.json must define schemaVersion = '0.7.3'.",
      "Every $id in docs/schema/0.7.3/*.schema.json must match its canonical host path.",
      "Makefile must include deterministic targets: normalize, preflight, preflight-fix, publish-schemas, codegen-check, and check-schema-ids.",
      "build.sh and preflight.sh must align with the flow spec and not mutate source state.",
      "docs/schema/<version>/ must differ from jsonschema/ only by host substitution in $id and $ref.",
      "No references to raw.githubusercontent.com are permitted.",
      "Ephemeral directories (.cache/, typescript/tmp/) must remain untracked."
    ],
    "sections": [
      "Repository State Summary",
      "Schema Source vs Published Artifact Boundary",
      "Version and Canonical Host Verification",
      "Makefile Entrypoint Integrity",
      "Preflight & Build Determinism",
      "Example Corpus Consistency",
      "Detected Divergences",
      "Remediation Actions"
    ]
  },
  "output": {
    "paths": [
      "meta/output/flow_audit_latest.md"
    ],
    "format": "Markdown",
    "must_write": true
  },
  "exit_criteria": [
    "meta/output/flow_audit_latest.md is written and non-empty",
    "All $id and $ref entries in published schemas use canonical URLs",
    "jsonschema sources preserve placeholder host with no extraneous fields",
    "No relative or mixed-host refs present in published artifacts",
    "No drift between jsonschema/ and docs/schema/<version>/ except host substitution",
    "Makefile and governance targets match flow specification",
    "Remediation section emitted when deviations are found"
  ]
}
